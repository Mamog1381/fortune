# ุฑุงูููุง ูพฺฉุฑุจูุฏ ูุฑุงุฒ ูพุงูฺฉ (Faraz SMS)

ุงู ุฑุงูููุง ูุญูู ุงุชุตุงู ู ุงุณุชูุงุฏู ุงุฒ ูพูู ูพุงูฺฉ ูุฑุงุฒ ุฏุฑ ูพุฑูฺู Coffee Fortune Server ุฑุง ุชูุถุญ ูโุฏูุฏ.

---

## ๐ฑ ุฏุฑุจุงุฑู ูุฑุงุฒ ูพุงูฺฉ

**ูุฑุงุฒ ูพุงูฺฉ** ฺฉ ุงุฒ ูพููโูุง ูุนุชุจุฑ ุงุฑุณุงู ูพุงูฺฉ ุฏุฑ ุงุฑุงู ุงุณุช ฺฉู ุณุฑูุณโูุง ูุชููุน ุงุฑุงุฆู ูโุฏูุฏ:
- ุงุฑุณุงู ูพุงูฺฉ ุณุงุฏู
- ุงุฑุณุงู ูพุงูฺฉ ุงูฺฏู ูุญูุฑ (Pattern-based) - ุณุฑุนโุชุฑ ู ุงุฑุฒุงูโุชุฑ
- ุฏุฑุงูุช ูพุงูฺฉ
- ูุฏุฑุช ุฎุทูุท ุงุฎุชุตุงุต

**ูุจุณุงุช**: https://farazsms.com
**ูพูู ฺฉุงุฑุจุฑ**: https://panel.ippanel.com

---

## ๐ ูุฑุญูู 1: ุซุจุชโูุงู ู ุฏุฑุงูุช ุงุทูุงุนุงุช

### 1.1 ุณุงุฎุช ุญุณุงุจ ฺฉุงุฑุจุฑ
1. ุจู https://farazsms.com ูุฑุงุฌุนู ฺฉูุฏ
2. ุฑู **ุซุจุชโูุงู** ฺฉูฺฉ ฺฉูุฏ
3. ุงุทูุงุนุงุช ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ ู ุญุณุงุจ ุจุณุงุฒุฏ
4. ููุจุงู ุฎูุฏ ุฑุง ุชุงุฏ ฺฉูุฏ

### 1.2 ุฎุฑุฏ ุงุนุชุจุงุฑ
1. ูุงุฑุฏ ูพูู ฺฉุงุฑุจุฑ ุดูุฏ: https://panel.ippanel.com
2. ุงุฒ ููู **ุฎุฑุฏ ุงุนุชุจุงุฑ** ุงูุฏุงู ุจู ุฎุฑุฏ ฺฉูุฏ
3. ุญุฏุงูู ุงุนุชุจุงุฑ ุชูุตู ุดุฏู: 50,000 ุชููุงู

### 1.3 ุฏุฑุงูุช API Key
1. ุฏุฑ ูพููุ ุจู ุจุฎุด **ุชูุธูุงุช** > **Web Service** ุจุฑูุฏ
2. **API Key** ุฎูุฏ ุฑุง ฺฉูพ ฺฉูุฏ
3. ุงู ฺฉูุฏ ุฑุง ุฏุฑ ุฌุง ุงูู ุฐุฎุฑู ฺฉูุฏ

### 1.4 ุฏุฑุงูุช ุดูุงุฑู ุงุฑุณุงูโฺฉููุฏู (Originator)
1. ุฏุฑ ูพููุ ุจู ุจุฎุด **ุฎุทูุท** ูุฑุงุฌุนู ฺฉูุฏ
2. ุดูุงุฑู 10 ุฑูู ุฎูุฏ ุฑุง ุงุฏุฏุงุดุช ฺฉูุฏ (ูุซูุงู: `3000XXXXX`)
3. ุงู ุดูุงุฑู ุฏุฑ ูพุงูฺฉโูุง ุจู ุนููุงู ูุฑุณุชูุฏู ููุงุด ุฏุงุฏู ูโุดูุฏ

---

## ๐ฏ ูุฑุญูู 2: ุณุงุฎุช ุงูฺฏู ูพุงูฺฉ (Pattern) - ุชูุตู ูโุดูุฏ

ุงูฺฏู ูพุงูฺฉ ุจุฑุง ุงุฑุณุงู OTP **ุณุฑุนโุชุฑุ ุงุฑุฒุงูโุชุฑ ู ุจูุชุฑ** ุงุณุช.

### 2.1 ุณุงุฎุช ุงูฺฏู
1. ุฏุฑ ูพููุ ุจู **ุงูฺฏููุง ูพุงูฺฉ** > **ุงุฌุงุฏ ุงูฺฏู** ุจุฑูุฏ
2. ุงุทูุงุนุงุช ุฒุฑ ุฑุง ูุงุฑุฏ ฺฉูุฏ:

**ูุงู ุงูฺฏู**: ฺฉุฏ ุชุงุฏ ฺฉุงู ูุงู

**ูุชู ุงูฺฏู**:
```
ฺฉุฏ ุชุงุฏ ุดูุง ุฏุฑ ฺฉุงู ูุงู:
%code%

Coffee Fortune verification code: %code%
```

**ุชูุถุญุงุช**: ฺฉุฏ ุชุงุฏ ุจุฑุง ูุฑูุฏ ุจู ุณุณุชู

3. ุฑู **ุซุจุช** ฺฉูฺฉ ฺฉูุฏ
4. **ฺฉุฏ ุงูฺฏู** (Pattern Code) ุฑุง ฺฉู ููุงุด ูโุฏูุฏ ุงุฏุฏุงุดุช ฺฉูุฏ (ูุซูุงู: `abc123xyz`)

### 2.2 ุงูุชุธุงุฑ ุจุฑุง ุชุงุฏ
- ุงูฺฏู ุดูุง ุจุงุฏ ุชูุณุท ูพุดุชุจุงู ูุฑุงุฒ ุชุงุฏ ุดูุฏ
- ูุนูููุงู 1-24 ุณุงุนุช ุทูู ูโฺฉุดุฏ
- ุจุนุฏ ุงุฒ ุชุงุฏ ูโุชูุงูุฏ ุงุฒ ุขู ุงุณุชูุงุฏู ฺฉูุฏ

---

## โ๏ธ ูุฑุญูู 3: ูพฺฉุฑุจูุฏ ูพุฑูฺู

### 3.1 ุงูุฒูุฏู ุจู ูุงู .env

ูุงู `.env` ุฎูุฏ ุฑุง ูุฑุงุด ฺฉูุฏ ู ุงุทูุงุนุงุช ุฒุฑ ุฑุง ุงุถุงูู ฺฉูุฏ:

```env
# SMS Provider Configuration
SMS_PROVIDER=faraz

# Faraz SMS Settings
FARAZ_API_KEY=your-api-key-from-panel-here
FARAZ_ORIGINATOR=3000XXXXX
FARAZ_PATTERN_CODE=abc123xyz
```

**ูุซุงู ูุงูุน**:
```env
SMS_PROVIDER=faraz
FARAZ_API_KEY=4TKFek8xPvBCwvDh9e2LqsJZnw1234567890abc
FARAZ_ORIGINATOR=3000505050
FARAZ_PATTERN_CODE=m8khs6qp2y
```

### 3.2 ูุตุจ ฺฉุชุงุจุฎุงูู requests (ุงฺฏุฑ ูุตุจ ูุณุช)

```bash
# ุฏุฑ ูุงู requirements.txt ุงุถุงูู ฺฉูุฏ:
requests>=2.31.0

# ุง ูุตุจ ูุณุชูู:
pip install requests
```

ุฏุฑ ูพุฑูฺู ุดูุง ุงุญุชูุงูุงู ุงุฒ ูุจู ูุตุจ ุงุณุช.

---

## ๐งช ูุฑุญูู 4: ุชุณุช

### 4.1 ุชุณุช ุฏุฑ ุญุงูุช DEBUG

ููุช `DEBUG=True` ุงุณุชุ ูพุงูฺฉ ุงุฑุณุงู ููโุดูุฏ ู ููุท ุฏุฑ console ููุงุด ุฏุงุฏู ูโุดูุฏ:

```bash
# ุดุฑูุน ุณุฑูุณโูุง
docker-compose up -d

# ุชุณุช ุงุฑุณุงู OTP
curl -X POST http://localhost:8000/api/accounts/request-otp/ \
  -H "Content-Type: application/json" \
  -d '{"phone_number": "09123456789"}'

# ฺฉุฏ OTP ุฑุง ุฏุฑ ูุงฺฏโูุง celery ุจุจูุฏ:
docker-compose logs -f celery
```

ุฎุฑูุฌ ุดุจู ุงู ุฎูุงูุฏ ุจูุฏ:
```
==================================================
[DEBUG MODE] OTP CODE
Phone: 09123456789
Code: 123456
==================================================
```

### 4.2 ุชุณุช ุฏุฑ Production (ุจุง ุงุฑุณุงู ูุงูุน ูพุงูฺฉ)

1. ูุทูุฆู ุดูุฏ `.env` ุดูุง ุชูุธู ุดุฏู ุงุณุช:
   ```env
   DEBUG=False
   FARAZ_API_KEY=<your-key>
   FARAZ_ORIGINATOR=<your-number>
   FARAZ_PATTERN_CODE=<your-pattern>
   ```

2. ุฑุณุชุงุฑุช ุณุฑูุณโูุง:
   ```bash
   docker-compose restart
   ```

3. ุงุฑุณุงู ุฏุฑุฎูุงุณุช:
   ```bash
   curl -X POST http://localhost:8000/api/accounts/request-otp/ \
     -H "Content-Type: application/json" \
     -d '{"phone_number": "09123456789"}'
   ```

4. ฺฺฉ ฺฉุฑุฏู ูุงฺฏโูุง:
   ```bash
   docker-compose logs -f celery
   ```

   ุงฺฏุฑ ููููุชโุขูุฒ ุจุงุดุฏ:
   ```
   OTP sent successfully to 09123456789
   ```

   ุงฺฏุฑ ุฎุทุง ุฑุฎ ุฏูุฏ:
   ```
   SMS provider failed to send OTP: <error message>
   ```

### 4.3 ุจุฑุฑุณ ุงุนุชุจุงุฑ

ูโุชูุงูุฏ ุงุนุชุจุงุฑ ุจุงููุงูุฏู ุฎูุฏ ุฑุง ฺฺฉ ฺฉูุฏ:

```python
# ุฏุฑ Django shell
docker-compose exec web python manage.py shell

from accounts.sms_providers import FarazSMSProvider
provider = FarazSMSProvider()
credit = provider.get_credit()
print(credit)
```

---

## ๐ ูุญูู ฺฉุงุฑฺฉุฑุฏ ุณุณุชู

### ุฌุฑุงู ุงุฑุณุงู OTP:

1. **ฺฉุงุฑุจุฑ ุฏุฑุฎูุงุณุช OTP ูโุฏูุฏ**
   ```
   POST /api/accounts/request-otp/
   Body: {"phone_number": "09123456789"}
   ```

2. **ุณุฑูุฑ ฺฉุฏ OTP ุชููุฏ ูโฺฉูุฏ** (6 ุฑูู)
   ```
   OTP: 582634
   ```

3. **ฺฉุฏ ุฏุฑ Redis ุฐุฎุฑู ูโุดูุฏ** (ุจุง TTL = 120 ุซุงูู)

4. **Task Celery ุจุฑุง ุงุฑุณุงู ูพุงูฺฉ ุงุฌุฑุง ูโุดูุฏ**

5. **ุจุณุชู ุจู ุชูุธูุงุช**:
   - **DEBUG=True**: ฺฉุฏ ููุท ุฏุฑ console ููุงุด ุฏุงุฏู ูโุดูุฏ
   - **DEBUG=False ุจุง Pattern**: ุงุฒ ุงูฺฏู ูพุงูฺฉ ุงุณุชูุงุฏู ูโุดูุฏ (ุณุฑุน ู ุงุฑุฒุงู)
   - **DEBUG=False ุจุฏูู Pattern**: ุงุฒ ุงุฑุณุงู ุณุงุฏู ุงุณุชูุงุฏู ูโุดูุฏ

6. **ฺฉุงุฑุจุฑ ูพุงูฺฉ ุฑุง ุฏุฑุงูุช ูโฺฉูุฏ**

7. **ฺฉุงุฑุจุฑ ฺฉุฏ ุฑุง ุชุงุฏ ูโฺฉูุฏ**
   ```
   POST /api/accounts/verify-otp/
   Body: {"phone_number": "09123456789", "otp_code": "582634"}
   ```

---

## ๐ง ุชูุธูุงุช ูพุดุฑูุชู

### ุชุบุฑ Provider

ุงฺฏุฑ ุจุฎูุงูุฏ ุงุฒ provider ุฏฺฏุฑ ุงุณุชูุงุฏู ฺฉูุฏ:

```env
SMS_PROVIDER=custom
```

ุณูพุณ ุฏุฑ `accounts/sms_providers.py` ฺฉูุงุณ provider ุฌุฏุฏ ุฑุง ุงุถุงูู ฺฉูุฏ.

### ุงุณุชูุงุฏู ุงุฒ ุงุฑุณุงู ุณุงุฏู (ุจุฏูู ุงูฺฏู)

ุงฺฏุฑ ุงูฺฏู ูุฏุงุฑุฏ ุง ููโุฎูุงูุฏ ุงุณุชูุงุฏู ฺฉูุฏ:

```env
# FARAZ_PATTERN_CODE ุฑุง ุฎุงู ุจฺฏุฐุงุฑุฏ ุง ุญุฐู ฺฉูุฏ
FARAZ_API_KEY=your-key
FARAZ_ORIGINATOR=your-number
# FARAZ_PATTERN_CODE ุฑุง ูุงุฑุฏ ูฺฉูุฏ
```

ุณุณุชู ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุงุฒ ุงุฑุณุงู ุณุงุฏู ุงุณุชูุงุฏู ูโฺฉูุฏ.

### ุณูุงุฑุดโุณุงุฒ ูุชู ูพุงูฺฉ

ุจุฑุง ุชุบุฑ ูุชู ูพุงูฺฉุ ูุงู `accounts/sms_providers.py` ุฑุง ูุฑุงุด ฺฉูุฏ:

```python
# ุฎุท 280 ุชูุฑุจุงู
def send_otp(self, phone_number: str, otp_code: str) -> Dict[str, any]:
    if self.pattern_code:
        return self.send_pattern(
            phone_number=phone_number,
            pattern_values={"code": otp_code}
        )
    else:
        # ุงู ูุชู ุฑุง ุชุบุฑ ุฏูุฏ
        message = f"ฺฉุฏ ุชุงุฏ ุดูุง: {otp_code}\n\nYour verification code: {otp_code}"
        return self.send_simple(
            phone_numbers=[phone_number],
            message=message
        )
```

---

## โ ุนุจโุงุจ ูุดฺฉูุงุช ุฑุงุฌ

### ูุดฺฉู 1: SMS provider is not configured
**ุนูุช**: `FARAZ_API_KEY` ุง `FARAZ_ORIGINATOR` ูุงุฑุฏ ูุดุฏู

**ุฑุงู ุญู**:
```bash
# ฺฺฉ ฺฉูุฏ ฺฉู .env ุตุญุญ ุงุณุช
cat .env | grep FARAZ

# ูุทูุฆู ุดูุฏ ุณุฑูุณโูุง restart ุดุฏูโุงูุฏ
docker-compose restart
```

### ูุดฺฉู 2: Pattern code is required
**ุนูุช**: `FARAZ_PATTERN_CODE` ุฎุงู ุงุณุช

**ุฑุงู ุญู**:
- ุง ุงูฺฏู ุจุณุงุฒุฏ ู ฺฉุฏ ุขู ุฑุง ูุงุฑุฏ ฺฉูุฏ
- ุง `FARAZ_PATTERN_CODE` ุฑุง ุญุฐู ฺฉูุฏ ุชุง ุงุฒ ุงุฑุณุงู ุณุงุฏู ุงุณุชูุงุฏู ุดูุฏ

### ูุดฺฉู 3: API returns 401 Unauthorized
**ุนูุช**: API Key ุงุดุชุจุงู ุงุณุช

**ุฑุงู ุญู**:
- API Key ุฑุง ุฏูุจุงุฑู ุงุฒ ูพูู ฺฉูพ ฺฉูุฏ
- ูุทูุฆู ุดูุฏ ูุงุตูู ุงุถุงู ูุฏุงุฑุฏ
- ูุทูุฆู ุดูุฏ ุฏุฑ ูุงู `.env` ุตุญุญ ุงุณุช

### ูุดฺฉู 4: API returns 403 Forbidden
**ุนูุช**: IP ุณุฑูุฑ ุดูุง ุฏุฑ ูพูู ุชุงุฏ ูุดุฏู

**ุฑุงู ุญู**:
- ุจู ูพูู ุจุฑูุฏ: **ุชูุธูุงุช** > **IP ูุง ูุฌุงุฒ**
- IP ุณุฑูุฑ VPS ุฎูุฏ ุฑุง ุงุถุงูู ฺฉูุฏ
- ุง ููู IP ูุง ุฑุง ูุฌุงุฒ ฺฉูุฏ (ุจุฑุง ุชุณุช)

### ูุดฺฉู 5: ุงูฺฏู ุชุงุฏ ููโุดูุฏ
**ุนูุช**: ุงูฺฏู ุจุงุฏ ุชูุณุท ูพุดุชุจุงู ูุฑุงุฒ ุชุงุฏ ุดูุฏ

**ุฑุงู ุญู**:
- ุตุจุฑ ฺฉูุฏ ุชุง ุชุงุฏ ุดูุฏ (1-24 ุณุงุนุช)
- ุจุง ูพุดุชุจุงู ุชูุงุณ ุจฺฏุฑุฏ
- ูููุชุงู ุงุฒ ุงุฑุณุงู ุณุงุฏู ุงุณุชูุงุฏู ฺฉูุฏ

### ูุดฺฉู 6: Credit is insufficient
**ุนูุช**: ุงุนุชุจุงุฑ ุดูุง ุชูุงู ุดุฏู

**ุฑุงู ุญู**:
```bash
# ฺฺฉ ฺฉุฑุฏู ุงุนุชุจุงุฑ
docker-compose exec web python manage.py shell
>>> from accounts.sms_providers import FarazSMSProvider
>>> provider = FarazSMSProvider()
>>> provider.get_credit()

# ุฎุฑุฏ ุงุนุชุจุงุฑ ุงุฒ ูพูู
```

---

## ๐ API Endpoints ูุฑุชุจุท

### ุงุฑุณุงู OTP
```bash
POST /api/accounts/request-otp/
Content-Type: application/json

{
  "phone_number": "09123456789"
}
```

**Response**:
```json
{
  "message": "OTP sent successfully",
  "phone_number": "09123456789",
  "expires_in": 120
}
```

### ุชุงุฏ OTP
```bash
POST /api/accounts/verify-otp/
Content-Type: application/json

{
  "phone_number": "09123456789",
  "otp_code": "123456"
}
```

**Response**:
```json
{
  "message": "Authentication successful",
  "user": {
    "id": "uuid",
    "phone_number": "09123456789"
  },
  "tokens": {
    "refresh": "refresh_token_here",
    "access": "access_token_here"
  }
}
```

---

## ๐ฐ ูุฒููโูุง ู ููุชโฺฏุฐุงุฑ

### ุงุฑุณุงู ุงูฺฏู ูุญูุฑ (Pattern)
- **ุณุฑุนโุชุฑ**: ุชูุฑุจุงู ููุฑ
- **ุงุฑุฒุงูโุชุฑ**: ุชูุฑุจุงู 50 ุชููุงู (ุจุณุชู ุจู ุชุนุฑูู)
- **ุชูุตู ูโุดูุฏ**: ุจุฑุง OTP

### ุงุฑุณุงู ุณุงุฏู (Simple)
- **ฺฉูุฏุชุฑ**: 5-10 ุซุงูู
- **ฺฏุฑุงูโุชุฑ**: ุชูุฑุจุงู 100 ุชููุงู (ุจุณุชู ุจู ุชุนุฑูู)
- **ุจุฑุง ูพุงูฺฉโูุง ูุชููุน**

### ูุญุงุณุจู ุชุนุฏุงุฏ ูพุงูฺฉ
ุจุง 100,000 ุชููุงู ุงุนุชุจุงุฑ:
- **ุงูฺฏู ูุญูุฑ**: ุชูุฑุจุงู 2000 ูพุงูฺฉ
- **ุงุฑุณุงู ุณุงุฏู**: ุชูุฑุจุงู 1000 ูพุงูฺฉ

---

## ๐ ูฺฉุงุช ุงููุช

1. **API Key ุฑุง ูุฑฺฏุฒ ุฏุฑ ฺฏุช commit ูฺฉูุฏ**
   ```bash
   # ูุทูุฆู ุดูุฏ .env ุฏุฑ .gitignore ุงุณุช
   echo ".env" >> .gitignore
   ```

2. **IP ูุง ูุฌุงุฒ ุฑุง ูุญุฏูุฏ ฺฉูุฏ**
   - ุฏุฑ ูพูู ูุฑุงุฒุ ููุท IP ุณุฑูุฑ ุฎูุฏ ุฑุง ูุฌุงุฒ ฺฉูุฏ

3. **Rate Limiting ุฑุง ูุนุงู ูฺฏู ุฏุงุฑุฏ**
   - ุณุณุชู ุจู ุตูุฑุช ูพุดโูุฑุถ rate limiting ุฏุงุฑุฏ
   - ูุฑ ุดูุงุฑู ููุท 1 OTP ุฏุฑ 60 ุซุงูู ูโุชูุงูุฏ ุฏุฑุงูุช ฺฉูุฏ

4. **ุงุนุชุจุงุฑ ุฑุง ูุงูุชูุฑ ฺฉูุฏ**
   - ุจู ุทูุฑ ููุธู ุงุนุชุจุงุฑ ุฎูุฏ ุฑุง ฺฺฉ ฺฉูุฏ
   - Alert ุชูุธู ฺฉูุฏ

---

## ๐ ูพุดุชุจุงู ูุฑุงุฒ ูพุงูฺฉ

- **ุชููู ูพุดุชุจุงู**: 021-91008200
- **ุงูู**: support@farazsms.com
- **ูุจุณุงุช**: https://farazsms.com
- **ูพูู**: https://panel.ippanel.com
- **ุชูฺฏุฑุงู**: @farazsms

---

## โ ฺฺฉ ูุณุช ููุง

ูุจู ุงุฒ production:
- [ ] ุญุณุงุจ ูุฑุงุฒ ูพุงูฺฉ ุณุงุฎุชู
- [ ] ุงุนุชุจุงุฑ ุฎุฑุฏู
- [ ] API Key ุฑุง ุฏุฑุงูุช ฺฉุฑุฏู
- [ ] ุดูุงุฑู Originator ุฑุง ุงุฏุฏุงุดุช ฺฉุฑุฏู
- [ ] ุงูฺฏู ูพุงูฺฉ ุณุงุฎุชู ู ุชุงุฏ ุดุฏ
- [ ] ฺฉุฏ ุงูฺฏู ุฑุง ุงุฏุฏุงุดุช ฺฉุฑุฏู
- [ ] ุงุทูุงุนุงุช ุฑุง ุฏุฑ `.env` ูุงุฑุฏ ฺฉุฑุฏู
- [ ] ุฏุฑ ุญุงูุช DEBUG ุชุณุช ฺฉุฑุฏู
- [ ] ุฏุฑ ุญุงูุช production ุชุณุช ฺฉุฑุฏู ู ูพุงูฺฉ ุฏุฑุงูุช ุดุฏ
- [ ] API Key ุฑุง ุฏุฑ ฺฏุช commit ูฺฉุฑุฏู

ููู ฺุฒ ุขูุงุฏู ุงุณุช! ๐

---

## ๐ ูุฑุงุญู ุจุนุฏ

ุจุนุฏ ุงุฒ ูพฺฉุฑุจูุฏ ูุฑุงุฒ ูพุงูฺฉ:
1. ูพุฑูฺู ุฑุง ุฑู VPS ุฏูพูู ฺฉูุฏ: [VPS_DEPLOYMENT.md](VPS_DEPLOYMENT.md)
2. ฺฺฉ ูุณุช ุฏูพูู ุฑุง ฺฉุงูู ฺฉูุฏ: [DEPLOYMENT_CHECKLIST.md](DEPLOYMENT_CHECKLIST.md)
3. API ูุง ุฑุง ุชุณุช ฺฉูุฏ: [API_DOCUMENTATION.md](API_DOCUMENTATION.md)
